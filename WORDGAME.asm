DATA SEGMENT
    
SEC1 DB 'NEW GAME "N"','$'
SEC2 DB 'LEVEL "L"','$'
SEC3 DB 'HIGH SCORE "H"','$'
SEC4 DB 'CREDITS "C"','$'
SEC5 DB 'EXIT "ESC"','$' 

OUTPUT1 DB 'Target:                                                              Score:','$'


HARD1  DB 'EASY   "E"','$'
HARD2  DB 'MEDIUM "M"','$'
HARD3  DB 'HARD   "H"','$' 

HIGHS  DB 'High Scores','$'
SCORE1 DB 0,"$"
SCORE2 DB 0,"$"
SCORE3 DB 0,"$"
SCORE4 DB 0,"$"
SCORE5 DB 0,"$"
      
INFO1 DB 'MEHMET NAIM TUFEKCI','$' 
INFO2 DB '21783336','$'  
INFO3 DB 'HACETTEPE UNIVERSITY','$'
INFO4 DB 'ELECTRICAL AND ELECTRONIC ENGINEERING','$'
INFO5 DB 'ELE338 - MICROPROCESSOR ARCHITECTURE AND PROGRAMMING LAB.','$'


FILE DB "mywords.txt",0
BUF DB ?
LETTERS DB "abcdefghijklmnopqrstuvyxz"
LINE_NUMBER DB ? 
WORD_NUMBER DB ?
WORD1 DB 11 DUP('$')
WORD_LONG DB 0
GAME_OV DB "GAME OVER","$"
    

LET1 DB ?
  
ROW DB ?
COL DB 1 DUP(10) 

KEYLOC DB 13 
OLDKEY DB 13
ERROR DB 0

SCORE DB 0


DATA ENDS

STACK SEGMENT
    DW   128  DUP(0)
STACK ENDS

CODE SEGMENT
START:
 
MOV AX,DATA
MOV DS,AX 

MOV AH,00H
MOV AL,03H;SET VIDEO MODE
INT 10H

MENU: 
;PAGE 0
MOV AH,05H
MOV AL,0 
INT 10H 

MOV AH,06H
MOV AL,00H
MOV BH,01110000B
MOV CX,0000
MOV DX,184FH
INT 10H


MOV DH,5  ;ROW
MOV DL,25  ;COLUMN
MOV BH,0  ;PAGE NUMBER
CALL LOC
LEA DX,SEC1
CALL DRAW 

MOV DH,7  ;ROW
MOV DL,25  ;COLUMN
MOV BH,0  ;PAGE NUMBER
CALL LOC
LEA DX,SEC2
CALL DRAW

MOV DH,9  ;ROW
MOV DL,25  ;COLUMN
MOV BH,0  ;PAGE NUMBER
CALL LOC
LEA DX,SEC3
CALL DRAW

MOV DH,11  ;ROW
MOV DL,25  ;COLUMN
MOV BH,0  ;PAGE NUMBER
CALL LOC
LEA DX,SEC4
CALL DRAW

MOV DH,13  ;ROW
MOV DL,25  ;COLUMN
MOV BH,0  ;PAGE NUMBER
CALL LOC
LEA DX,SEC5
CALL DRAW 


GET_CHAR:

MOV AH,07H ;GET A CHARACTER
INT 21H

CMP AL,04EH  ;PRESS "N" OR "n" FOR GOING TO NEW GAME
JE NEWGAME 
CMP AL,06EH  
JE NEWGAME
  
CMP AL,04CH  ;PRESS "L" OR "l" FOR GOING TO LEVEL
JE LEVEL
CMP AL,06CH
JE LEVEL 

CMP AL,048H
JE HIGHSCORE  ;PRESS "H" OR "h" FOR GOING TO HIGH SCORES
CMP AL,068H
JE HIGHSCORE 

CMP AL,043H  ;PRESS "C" OR "c" FOR GOING TO CREDITS
JE CREDITS 
CMP AL,063H
JE CREDITS

CMP AL,01BH  ;PRESS "ESC" FOR EXITTING THE GAME
JE EXIT

JMP GET_CHAR


NEWGAME:
;PAGE 1
MOV AH,05H
MOV AL,1 
INT 10H 
MOV AH,06H
MOV AL,00H
MOV BH,01110000B
MOV CX,0000
MOV DX,184FH
INT 10H 

MOV DH,0  ;ROW
MOV DL,0 ;COLUMN 

;GAME SCREEN
SIDE1:
PUSH DX

MOV BH,1  ;PAGE NUMBER
CALL LOC

MOV DL,58H
CALL PRINT 

POP DX
MOV DH,0 
CMP DL,79
JE GO
INC DL 
JMP SIDE1

GO:

MOV DH,0  ;ROW
MOV DL,79 ;COLUMN 

SIDE2:
PUSH DX

MOV BH,1  ;PAGE NUMBER
CALL LOC

MOV DL,58H
CALL PRINT 

POP DX

MOV DL,79 
CMP DH,23 
JE GO1

INC DH 
JMP SIDE2 

GO1: 

MOV DH,1  ;ROW
MOV DL,0 ;COLUMN 

SIDE3:
PUSH DX

MOV BH,1  ;PAGE NUMBER
CALL LOC

MOV DL,58H
CALL PRINT 

POP DX

MOV DL,0 
CMP DH,23 
JE GO2

INC DH 
JMP SIDE3

GO2:

MOV DH,23  ;ROW
MOV DL,0 ;COLUMN 

SIDE4:
PUSH DX

MOV BH,1  ;PAGE NUMBER
CALL LOC

MOV DL,58H
CALL PRINT 

POP DX

MOV DH,23 
CMP DL,79 
JE GO3

INC DL 
JMP SIDE4 

GO3:


MOV DH,21  ;ROW
MOV DL,1 ;COLUMN 

LINE1:
PUSH DX

MOV BH,1  ;PAGE NUMBER
CALL LOC

MOV DL,0C4H
CALL PRINT 

POP DX

MOV DH,21 
CMP DL,78 
JE GO4

INC DL 
JMP LINE1 

GO4:

MOV DH,22
MOV DL,1
MOV BH,1  ;PAGE NUMBER
CALL LOC

LEA DX,OUTPUT1
CALL DRAW  


;GAME 

;RANDOM WORD
CALL RANDOM_NUMBER  ;FIND A RANDOM NUMBER FOR RANDOM WORD
LEA SI,LINE_NUMBER
MOV [SI],DX         ;STORE THE RANDOM NUMBER INTO "LINE_NUMBER"

LEA DX,FILE
MOV AL,0
MOV AH,3DH
INT 21H

MOV BX,AX
MOV CX,1

READ_CHAR:
LEA DX,BUF
MOV AH,3FH
INT 21H

MOV AL,DS:[BUF]
CMP AL,10
JE COUNT
JMP READ_CHAR

COUNT:
ADD DS:[WORD_NUMBER],1
MOV AL,DS:[LINE_NUMBER]
CMP DS:[WORD_NUMBER],AL
JE  WRITE               ;COUNT WORDS UNTIL THE RANDOM NUMBER IS EQUAL TO WORD NUMBER
JMP READ_CHAR

WRITE:
LEA SI,WORD1
LEA DX,BUF

WRITE_WORD:
MOV AH,3FH ;GET A CHARACTER FROM THE FILE
INT 21H

MOV AL,DS:[BUF]

CMP AL,0DH
JE PRINT_WORD 

MOV [SI],AL
INC SI
ADD DS:[WORD_LONG],1   ;COUNT THE LENGTH OF WORD
JMP WRITE_WORD

PRINT_WORD:

LEA DI,WORD1
DEC DI
MOV DL,8
WRITE_AGAIN: 
MOV DH,22
MOV BH,1  ;PAGE NUMBER
CALL LOC 
INC DI 

CMP [DI],'$'
JE EXIT_WRITE


INC DL
MOV AH,09H
MOV AL,[DI]  ;PRINT THE CHARACTER ON THE SCREEN
MOV BH,1
MOV BL,01110100B
MOV CX,1
INT 10H

JMP WRITE_AGAIN

EXIT_WRITE:
     
AGAIN1:
LEA DI,LET1 
   
   
CALL RANDOM_NUMBER ;FIND A RANDOM NUMBER FOR RANDOM LETTER
MOV CX,DX 
  
LEA SI,LETTERS

  
 
RANDOM_LETTER: ;FIND RANDOM LETTER
  
 MOV AL,[SI]
 INC SI
 MOV [DI],AL
 LOOP RANDOM_LETTER 
 

 
 LEA DI,ROW
 CALL RANDOM_ROW ;FIND RANDOM ROW NUMBER
  
 MOV [DI],DX 
  

;START THE LETTER ON FIFTH COLUMN AND RANDOM ROW AND MOVES ON FROM LEFT TO RIGHT 
 MOV DL,5
LABEL1: 
 
 INC DL
 INC DL
 INC DL
 
 MOV DH,DS:[ROW] 
 MOV BH,1
 MOV AH,02H
 INT 10H  


 MOV CX, 1
 MOV BH, 1
 MOV AL,DS:[LET1]
 MOV AH, 0AH
 INT 10H
  
 MOV DH,DS:[ROW] 
 MOV BH,1
 MOV AH,02H
 INT 10H
 
 MOV CX,1
 MOV BH,1
 MOV AL,' '  
 MOV AH, 0AH
 INT 10H 
 
 PUSH DX
 
 MOV DL,77
 MOV DH,DS:[KEYLOC]  
 MOV BH,1
 MOV AH,02H
 INT 10H  


 MOV CX,1
 MOV BH,1
 MOV Al,62  
 MOV AH,0AH
 INT 10H
 
 MOV AH, 01H  ;CHECK TO PRESS ANY KEY
 INT 16H
                                                                                
 JZ NO_KEY_PRESS
 
 CMP AL,1BH  ;IF PRESSED "ESC",EXIT THE GAME
 JE EXIT

 MOV AH,0H
 INT 16H
 
 CMP AH,48H      
 JNE UP
 SUB DS:[KEYLOC],1  ;IF PRESSED "UP",DECREASE ROW NUMBER OF ">" 
 JMP GIT
 UP:
 CMP AH,50H
 JNE GIT
 ADD DS:[KEYLOC],1   ;IF PRESSED "DOWN",INCREASE ROW NUMBER OF ">" 
  
 GIT:
 MOV DL,77
 MOV DH,DS:[OLDKEY]  ;FIND OLD LOCATION OF ">"   
 MOV BH,1
 MOV AH,02H
 INT 10H  


 MOV CX,1
 MOV BH,1
 MOV AL,' ' 
 MOV AH,0AH
 INT 10H 
 
 MOV AL,DS:[KEYLOC]
 MOV DS:[OLDKEY],AL
 
 NO_KEY_PRESS:
 

 POP DX 

 
 CMP DL,74
 JBE LABEL1 ;MOVE LETTER FROM LEFT TO RIGHT UNTIL 74. COLUMN
 
 CMP DH,DS:[KEYLOC]   ;CHECK FOR CATCHING THE LETTER
 JNE AGAIN1

 CALL CHANGE_COLOR  ;IF TRUE LETTER IS CATCHED,CHANGE IT'S COLOR

 CMP DS:[ERROR],1
 JE GAME_END       ;IF FALSE LETTER IS CATCHED ,FINISH THE GAME
 
 MOV AL,DS:[SCORE]
 CMP DS:[WORD_LONG],AL ;IF ALL LETTERS OF WORD ARE FIND,GET A NEW RANDOM WORD
 JNE AGAIN1
 
 CALL SCORE_ORDER
 
 JMP NEWGAME 



GAME_END: 

CALL SCORE_ORDER
CALL GAME_OVER   ;IF GAME IS OVER,PRINT A BIG RED "X" ON THE SCREEN

MOV AH,07H ;GET A CHARACTER
INT 21H 

JMP MENU 


LEVEL:  
;PAGE 2
MOV AH,05H
MOV AL,2 
INT 10H
MOV AH,06H
MOV AL,00H
MOV BH,01110000B
MOV CX,0000
MOV DX,184FH
INT 10H

MOV DH,5  ;ROW
MOV DL,25  ;COLUMN
MOV BH,2  ;PAGE NUMBER
CALL LOC
LEA DX,HARD1
CALL DRAW 

MOV DH,7  ;ROW
MOV DL,25  ;COLUMN
MOV BH,2  ;PAGE NUMBER
CALL LOC
LEA DX,HARD2
CALL DRAW

MOV DH,9  ;ROW
MOV DL,25  ;COLUMN
MOV BH,2  ;PAGE NUMBER
CALL LOC
LEA DX,HARD3
CALL DRAW  

MOV AH,07H ;GET A CHARACTER
INT 21H 

CMP AL,1BH  ;PRESS "ESC" FOR EXITTING THE GAME
JE EXIT 
JMP MENU 


HIGHSCORE:

MOV AH,05H
MOV AL,3 
INT 10H
MOV AH,06H
MOV AL,00H
MOV BH,01110000B
MOV CX,0000
MOV DX,184FH
INT 10H 

MOV DH,5  ;ROW
MOV DL,10  ;COLUMN
MOV BH,3  ;PAGE NUMBER
CALL LOC 

LEA DX,HIGHS
CALL DRAW

MOV DH,8 ;ROW
MOV DL,10  ;COLUMN
MOV BH,3  ;PAGE NUMBER
CALL LOC

    MOV DL,DS:[SCORE1]  ;PRINT THE 1ST SCORE 
    ADD DL,30H
    MOV AH,02H
    INT 21H
    
MOV DH,10 ;ROW
MOV DL,10  ;COLUMN
MOV BH,3  ;PAGE NUMBER
CALL LOC

    MOV DL,DS:[SCORE2]  ;PRINT THE 2ND SCORE  
    ADD DL,30H
    MOV AH,02H
    INT 21H
  

MOV DH,12 ;ROW
MOV DL,10  ;COLUMN
MOV BH,3  ;PAGE NUMBER
CALL LOC    
    MOV DL,DS:[SCORE3]  ;PRINT THE 3RD SCORE 
    ADD DL,30H
    MOV AH,02H
    INT 21H
   

MOV DH,14 ;ROW
MOV DL,10  ;COLUMN
MOV BH,3  ;PAGE NUMBER
CALL LOC    
    MOV DL,DS:[SCORE4]  ;PRINT THE 4TH SCORE
    ADD DL,30H
    MOV AH,02H
    INT 21H
   
     
MOV DH,16 ;ROW
MOV DL,10  ;COLUMN
MOV BH,3  ;PAGE NUMBER
CALL LOC     
    MOV DL,DS:[SCORE5]  ;PRINT THE 5TH SCORE
    ADD DL,30H
    MOV AH,02H
    INT 21H
 
MOV AH,07H ;GET A CHARACTER
INT 21H  

CMP AL,1BH  ;PRESS "ESC" FOR EXITTING THE GAME
JE EXIT 

JMP MENU

CREDITS:
;PAGE 4
MOV AH,05H
MOV AL,4 
INT 10H
MOV AH,06H
MOV AL,00H
MOV BH,01110000B
MOV CX,0000
MOV DX,184FH
INT 10H


MOV DH,5  ;ROW
MOV DL,10  ;COLUMN
MOV BH,4  ;PAGE NUMBER
CALL LOC
LEA DX,INFO1
CALL DRAW 

MOV DH,7  ;ROW
MOV DL,10  ;COLUMN
MOV BH,4  ;PAGE NUMBER
CALL LOC
LEA DX,INFO2
CALL DRAW

MOV DH,9  ;ROW
MOV DL,10  ;COLUMN
MOV BH,4  ;PAGE NUMBER
CALL LOC
LEA DX,INFO3
CALL DRAW

MOV DH,11  ;ROW
MOV DL,10  ;COLUMN
MOV BH,4  ;PAGE NUMBER
CALL LOC
LEA DX,INFO4
CALL DRAW

MOV DH,13  ;ROW
MOV DL,10  ;COLUMN
MOV BH,4  ;PAGE NUMBER
CALL LOC
LEA DX,INFO5
CALL DRAW


MOV AH,07H ;GET A CHARACTER
INT 21H 

CMP AL,1BH  ;PRESS "ESC" FOR EXITTING THE GAME
JE EXIT  
JMP MENU


EXIT:




HLT


;PROCEDURE
;FOR LOCATIONS
LOC PROC 
     MOV AH,02H ;SET CURSOR POSITION
     INT 10H 
     RET
LOC ENDP  
;FOR PRINTING A STRING
DRAW PROC 
    MOV     AH,09H ;PRINT A STRING
    INT     21H
    RET
DRAW ENDP 
;FOR PRINTING A CHARACTER
PRINT PROC
    MOV AH,02H  ;PRINT A CHARACTER
    INT 21H
    RET
PRINT ENDP 
 

;FOR FINDING A RANDOM NUMBER 
RANDOM_NUMBER PROC
    PUSH BX
    MOV AX,0H            
    INT 1AH              
    MOV AX,DX            
    MOV DX,0H            
    MOV BX,25            
    DIV BX
    ADD DX,1    
    POP BX
    RET
RANDOM_NUMBER ENDP 

;FOR FINDING A RANDOM ROW
RANDOM_ROW PROC
    MOV AX,0H            
    INT 1AH              
    MOV AX,DX            
    MOV DX,0H            
    MOV BX,18            
    DIV BX
    ADD DX,2 
    RET
RANDOM_ROW ENDP  

;FOR CHECKING THE LETTER IS IN THE WORD OR NOT
CHANGE_COLOR proc
     
    LEA SI,WORD1
    MOV AL,DS:[LET1] 
    
    MOV DL,8 
    MOV DH,22
    MOV DS:[ERROR],1
      
    LOOP1:
    CMP [SI],'$'
    JE END_LOOP
     
    CMP [SI], al
    JE EQUALS
                 
    INCREMENT:
    INC SI
    INC DL   
    JMP LOOP1    
                 
    EQUALS:
    
    MOV BH,1  ;PAGE NUMBER
    MOV AH,02H ;SET CURSOR POSITION
    INT 10H
    MOV AH,09H
    MOV AL,[SI]
    MOV BH,1
    MOV BL,01110010B  ;IF THE LETTER IS IN THE WORD,MAKE ITS COLOR GREEN
    MOV CX,1
    INT 10H 
    
    MOV DS:[ERROR],0 ;IF THE LETTER IS IN THE WORD,MAKE ERROR "0"
    ADD DS:[SCORE],1 ;IF THE LETTER IS IN THE WORD,COUNT THE TRUE CATCHED 
    
    PUSH DX
      
    MOV DH,22  ;ROW
    MOV DL,76  ;COLUMN
    MOV BH,1  ;PAGE NUMBER
    MOV AH,02H ;SET CURSOR POSITION
    INT 10H  
    
    MOV DL,DS:[SCORE]  ;PRINT THE SCORE 
    ADD DL,30H
    MOV AH,02H
    INT 21H
 
       
    
    POP DX
    
    JMP INCREMENT         
 
    END_LOOP:
    
    RET
CHANGE_COLOR ENDP 


;FOR FINISHING THE GAME
GAME_OVER PROC
    
    MOV AH,05H
    MOV AL,1 
    INT 10H 

    MOV AH,06H
    MOV AL,00H
    MOV BH,01110100B
    MOV CX,0000
    MOV DX,184FH
    INT 10H  

    MOV DH,3  ;ROW
    MOV DL,25 ;COLUMN 

S1:
    PUSH DX  
    
    MOV BH,1  ;PAGE NUMBER
    MOV AH,02H ;SET CURSOR POSITION
    INT 10H 

    MOV DL,58H  
    MOV AH,02H  ;PRINT A CHARACTER
    INT 21H
   
    POP DX 
    
    INC DH
    INC DL

    CMP DH,20
    JNE  S1

    CMP DL,42
    JNE S1

    MOV DH,3  ;ROW
    MOV DL,41 ;COLUMN 

S2:
    PUSH DX

    MOV BH,1  ;PAGE NUMBER
    MOV AH,02H ;SET CURSOR POSITION
    INT 10H 

    MOV DL,58H
    MOV AH,02H  ;PRINT A CHARACTER
    INT 21H

    POP DX 
    
    INC DH
    DEC DL

    CMP DH,20
    JNE S2
    CMP DL,24
    JNE S2


    MOV DH,22  ;ROW
    MOV DL,29 ;COLUMN 
    MOV BH,1  ;PAGE NUMBER
    MOV AH,02H ;SET CURSOR POSITION
    INT 10H 

    LEA DX,GAME_OV
    MOV AH,09H ;PRINT A STRING
    INT 21H
    RET
GAME_OVER ENDP 

;FOR FINDING FIRST 5 HIGH SCORES
SCORE_ORDER PROC
MOV AL,DS:[SCORE]
MOV BL,DS:[SCORE1]
CMP AL,BL
JB NXT1  

MOV DS:[SCORE1],AL
MOV DS:[SCORE],BL

NXT1:
MOV AL,DS:[SCORE]
MOV BL,DS:[SCORE2]
CMP AL,BL
JB NXT2  

MOV DS:[SCORE2],AL
MOV DS:[SCORE],BL

NXT2:
MOV AL,DS:[SCORE]
MOV BL,DS:[SCORE3]
CMP AL,BL
JB NXT3 

MOV DS:[SCORE3],AL
MOV DS:[SCORE],BL

NXT3:
MOV AL,DS:[SCORE]
MOV BL,DS:[SCORE4]
CMP AL,BL
JB NXT4

MOV DS:[SCORE4],AL
MOV DS:[SCORE],BL

NXT4:
MOV AL,DS:[SCORE]
MOV BL,DS:[SCORE5]
CMP AL,BL
JB NXT5

MOV DS:[SCORE5],AL
MOV DS:[SCORE],0
NXT5:  
    RET
SCORE_ORDER ENDP

CODE ENDS

END START
